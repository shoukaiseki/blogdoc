<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>蒋カイセキ 的博客</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">蒋カイセキ 的博客</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Linux加载模块命令</h2>
	<h5 id="">2011-12-17 14:28:29&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/shoukaiseki/blog/static/1928561492011111722829211/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>安装模块</div><div>　　insmod *.ko</div><div>　　卸载模块</div><div>　　rmmod *.ko</div><div>　　查看已经安装的模块</div><div>　　lsmod</div><div>　　cat /proc/modules</div><div>　　查看模块输出</div><div>　　tail /var/log/messages</div><div>　　//</div><div>　　1．编译工具make</div><div>　　实际上，make 工具通过一个称为 Makefile 的文件来完成并自动维护编译工作。Makefile 需要按照某种语法进行编写，其中说明了如何编译各个源文件并连接生成可执行文件，并定义了源文件之间的依赖关系。下面给出2.6 内核模块的Makefile模板（请参看Makefile的写法）</div><div>　　# Makefile2.6</div><div>　　obj-m += hellomod.o # 产生hellomod 模块的目标文件</div><div>　　CURRENT_PATH := $(shell pwd) #模块所在的当前路径</div><div>　　LINUX_KERNEL := $(shell uname -r) #Linux内核源代码的当前版本</div><div>　　LINUX_KERNEL_PATH := /usr/src/linux-headers-$(LINUX_KERNEL) #Linux内核源代码的绝对路径</div><div>　　all:</div><div>　　make -C $(LINUX_KERNEL_PATH) M=$(CURRENT_PATH) modules #编译模块了</div><div>　　clean:</div><div>　　make -C $(LINUX_KERNEL_PATH) M=$(CURRENT_PATH) clean #清理</div><div>　　注意： 在每个命令前（例如make命令前）要键入一个制表符（按TAB键产生）</div><div>　　有了Makefile,执行make命令，会自动形成相关的后缀为.o和.ko文件。</div><div>　　到此，模块编译好了，该把它插入到内核了：</div><div>　　如：$insmod hellomod.ko</div><div>　　当然，要以系统员的身份才能把模块插入。</div><div>　　成功插入后，可以通过dmesg命令查看，屏幕最后几行的输出就是你程序中输出的内容：Hello,World! from the kernel space…</div><wbr></div>
	</div>
</div>
</body>
</html>