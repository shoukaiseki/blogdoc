<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>蒋カイセキ 的博客</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">蒋カイセキ 的博客</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">java的多线程</h2>
	<h5 id="">2011-08-28 17:49:07&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/shoukaiseki/blog/static/192856149201172854521732/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><font size="5"  color="#ff0000"  >查看高亮源码<a target="_blank" rel="nofollow" href="http://hi.baidu.com/jiangxinyi21/blog/item/c6d0a12e80720d0c8b82a14f.html"  >http://hi.baidu.com/jiangxinyi21/blog/item/c6d0a12e80720d0c8b82a14f.html</a></font></div><div>/*</div><div>结果没有按照顺序递减,但是没有重复,输出也没超标,可能跟双核CPU的关系</div><div>*/</div><div>public class runnable</div><div>{</div><div><span style="white-space:pre;"  > </span>public static void main(String [] args)</div><div><span style="white-space:pre;"  > </span>{</div><div><span style="white-space:pre;"  >  </span>TestThread t = new TestThread() ;</div><div><span style="white-space:pre;"  > </span>//<span style="white-space:pre;"  > </span>SetNameThreadDemo tt = new SetNameThreadDemo();</div><div><span style="white-space:pre;"  >  </span>// 启动了六个线程,并实现了资源共享的目的</div><div><span style="white-space:pre;"  >  </span>Thread a = new Thread(t);//创建匿名对象并开启线程</div><div><span style="white-space:pre;"  >  </span>System.out.println("1= "+a.isAlive());</div><div><span style="white-space:pre;"  >  </span>a.start();</div><div><span style="white-space:pre;"  >  </span>System.out.println("1 = "+ a.isAlive());</div><div><span style="white-space:pre;"  >  </span>Thread b = new Thread(t,"2");//设置进程名</div><div><span style="white-space:pre;"  >  </span>b.start();</div><div><span style="white-space:pre;"  >  </span>Thread c = new Thread(t);</div><div><span style="white-space:pre;"  >  </span>c.start();</div><div><span style="white-space:pre;"  >  </span>c.setName("3");</div><div><span style="white-space:pre;"  >  </span>new Thread(t,"4").start();</div><div><span style="white-space:pre;"  >  </span>new Thread(t,"5").start();</div><div><span style="white-space:pre;"  >  </span>new Thread(t,"6").start();</div><div><span style="white-space:pre;"  >  </span></div><div><span style="white-space:pre;"  >  </span>System.out.println("2 = "+ b.isAlive());</div><div><span style="white-space:pre;"  >  </span>System.out.println("3 = "+ c.isAlive());</div><div><span style="white-space:pre;"  > </span>}</div><div>}</div><div>/*</div><div>很多其它线程比较过了之后再去减1,然后休眠,如果比较时tickets=1,此线程进入休眠,其它线程也继续比较,然后休眠,最后休眠中的线程重新开始执行,导致出现tickets=-1,-2,-3,-4的情况</div><div>因此加入同步代码块(synchronized),同步代码块的含义就是,只有一个进程在代码块中执行,就像WC一样,其余人要等待,等他上完才能进去其它人.</div><div>还可以同步方法,看下面程序</div><div>*/</div><div>/*</div><div>class TestThread &nbsp;implements Runnable// extends Thread</div><div>{</div><div><span style="white-space:pre;"  > </span>private int tickets=200;</div><div><span style="white-space:pre;"  > </span>public void run()</div><div><span style="white-space:pre;"  > </span>{</div><div><span style="white-space:pre;"  >  </span>while(true)</div><div><span style="white-space:pre;"  >  </span>{</div><div><span style="white-space:pre;"  >   </span>try</div><div><span style="white-space:pre;"  >   </span>{</div><div><span style="white-space:pre;"  >    </span>Thread.sleep(100);</div><div><span style="white-space:pre;"  >   </span>}</div><div><span style="white-space:pre;"  >   </span>catch(Exception f){}//在同步代码块前线程休眠一段时间,给其它线程执行的机会,不然出现独占严重</div><div><span style="white-space:pre;"  >   </span>synchronized(this)</div><div><span style="white-space:pre;"  >   </span>{</div><div><span style="white-space:pre;"  >    </span>if(tickets&gt;0)</div><div><span style="white-space:pre;"  >    </span>{</div><div><span style="white-space:pre;"  >     </span>try//休眠会出现异常,所以需要异常处理</div><div><span style="white-space:pre;"  >     </span>{</div><div><span style="white-space:pre;"  >      </span>Thread.sleep(100);//线程休眠100ms</div><div><span style="white-space:pre;"  >     </span>}</div><div><span style="white-space:pre;"  >     </span>catch(Exception e){}</div><div><span style="white-space:pre;"  >     </span>System.out.println(Thread.currentThread().getName()+"="+tickets--);</div><div><span style="white-space:pre;"  >    </span>}</div><div><span style="white-space:pre;"  >   </span>}</div><div><span style="white-space:pre;"  >  </span>}</div><div><span style="white-space:pre;"  > </span>}</div><div>}</div><div>*/</div><div>/*</div><div>同步方法</div><div>*/</div><div>class TestThread &nbsp;implements Runnable// extends Thread</div><div>{</div><div><span style="white-space:pre;"  > </span>private int tickets=200;</div><div><span style="white-space:pre;"  > </span>public void run()</div><div><span style="white-space:pre;"  > </span>{</div><div><span style="white-space:pre;"  >  </span>while(tickets!=0)</div><div><span style="white-space:pre;"  >  </span>{</div><div><span style="white-space:pre;"  >   </span>try</div><div><span style="white-space:pre;"  >   </span>{</div><div><span style="white-space:pre;"  >    </span>Thread.sleep(100);</div><div><span style="white-space:pre;"  >   </span>}</div><div><span style="white-space:pre;"  >   </span>catch(Exception f){}//在调用同步方法前线程休眠一段时间,给其它线程执行的机会,不然出现独占严重</div><div><span style="white-space:pre;"  >   </span>sale();</div><div><span style="white-space:pre;"  >  </span>}</div><div><span style="white-space:pre;"  > </span>}</div><div><span style="white-space:pre;"  > </span>public synchronized void sale()//同步方法</div><div><span style="white-space:pre;"  > </span>{</div><div><span style="white-space:pre;"  >  </span>if(tickets&gt;0)</div><div><span style="white-space:pre;"  >  </span>{</div><div><span style="white-space:pre;"  >   </span>try//休眠会出现异常,所以需要异常处理</div><div><span style="white-space:pre;"  >   </span>{</div><div><span style="white-space:pre;"  >    </span>Thread.sleep(100);//线程休眠100ms</div><div><span style="white-space:pre;"  >   </span>}</div><div><span style="white-space:pre;"  >   </span>catch(Exception e){}</div><div><span style="white-space:pre;"  >   </span>System.out.println(Thread.currentThread().getName()+"="+tickets--);</div><div><span style="white-space:pre;"  >  </span>}</div><div><span style="white-space:pre;"  > </span>}</div><div><br></div><div>}</div><div><br></div><wbr></div>
	</div>
</div>
</body>
</html>