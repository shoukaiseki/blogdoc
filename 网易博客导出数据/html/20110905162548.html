<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>蒋カイセキ 的博客</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">蒋カイセキ 的博客</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Java访问sql数据库(数据源方式)</h2>
	<h5 id="">2011-09-05 16:25:48&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/shoukaiseki/blog/static/19285614920118542548681/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><span style="font-family: 'MS PGothic'; line-height: normal; font-size: medium;"  ><div style="background-color: rgb(255, 255, 255); font-size: 14px; font-family: Arial, 宋体; margin-top: 10px; margin-right: 10px; margin-bottom: 10px; margin-left: 10px; cursor: text; line-height: 1.8; word-wrap: break-word;"  ><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  >建立(ODBC)数据源和驱动程序</p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  >　　在控制面板上通过“管理工具”的“数据源(ODBC)”打开“ODBC数据源管理器”对话框，单击“系统DSN”选项卡，然后单击“添加”按钮，得到“创建数据源”对话框，选择“SQL Server”并单击“完成”按钮，在出现的“建立新的数据源到SQL Server”对话框中的“数据源名称”项填写“wzgl”并选取“服务器名”，然后单击“下一步”按钮，选择“使用网络登录ID的Windows NT验证”项目，单击“下一步”按钮，把默认的数据库改为“mydata”，再单击“下一步”，单击“完成”按钮，然后可以单击“测试数据源”，成功后，单击“确定”按钮，完成了(ODBC)数据源和驱动程序的建立。</p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  >新建表 wuzi</p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><span align=""  ><img title="Java访问sql数据库(数据源方式) - Linux Fedora 15 - 蒋カイセキ的博客"  alt="Java访问sql数据库(数据源方式) - Linux Fedora 15 - 蒋カイセキ的博客"  src="http://img.ph.126.net/wrvhTbgWgS4Cw3HluF2JZw==/808677608091709717.jpg"  _fcksavedurl="http://hiphotos.baidu.com/jiangxinyi21/pic/item/8f2c9011e555e72842a9ade4.jpg"  small="0"  border="0"  align=""  ></span>?<span align=""  ><img title="Java访问sql数据库(数据源方式) - Linux Fedora 15 - 蒋カイセキ的博客"  alt="Java访问sql数据库(数据源方式) - Linux Fedora 15 - 蒋カイセキ的博客"  src="http://img.ph.126.net/TmCPc_CTg81t4G3V0eIQMA==/808677608091709718.jpg"  _fcksavedurl="http://hiphotos.baidu.com/jiangxinyi21/pic/item/8c5afe5ce3dfc235d00906e4.jpg"  small="0"  border="0"  align=""  ></span>?<br></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  >运行结果</p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><span align=""  ><img title="Java访问sql数据库(数据源方式) - Linux Fedora 15 - 蒋カイセキ的博客"  alt="Java访问sql数据库(数据源方式) - Linux Fedora 15 - 蒋カイセキ的博客"  src="http://img.ph.126.net/rHCX6LTv9Qh0HDv2ZxuugQ==/808677608091709719.jpg"  _fcksavedurl="http://hiphotos.baidu.com/jiangxinyi21/pic/item/7e8b9119e49ae013cb80c41c.jpg"  small="0"  border="0"  align=""  ></span>?<br><br></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  >源代码jdbc.java&nbsp;<a style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; " target="_blank" rel="nofollow" href="http://115.com/file/e6e8907z#"  >http://115.com/file/e6e8907z#</a></p></div></span><span style="font-family: Arial, 宋体;"  >查看高亮显示源码 &nbsp;</span><a style="font-family: 'MS PGothic'; font-size: medium; line-height: normal; " target="_blank" rel="nofollow" href="http://hi.baidu.com/jiangxinyi21/blog/item/77aa742446f19af78a1399af.html"  >http://hi.baidu.com/jiangxinyi21/blog/item/77aa742446f19af78a1399af.html</a><div style="background-color: rgb(255, 255, 255); margin-top: 10px; margin-right: 10px; margin-bottom: 10px; margin-left: 10px; cursor: text; word-wrap: break-word;"  ><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >import java.awt.*;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >import java.awt.event.*;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >import java.sql.*;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >import java.util.*;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >import javax.swing.*;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >public class jdbc //定义主类</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>public static void main(String args[])</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>GUI gui=new GUI(); //创建类GUI的对象</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>gui.pack(); //装载执行GUI类</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >class GUI extends Frame implements ActionListener</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>TextArea text;Panel panel;TextField sno; Button btn;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>GUI() //构造方法</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>super("物资情况查询");setLayout(new BorderLayout());</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>setBackground(Color.cyan);</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>setVisible(true);text=new TextArea();</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>btn=new Button("查询");//加载按钮</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>sno=new TextField(16);//加载输入框宽带16</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>panel=new Panel();</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>panel.add(new Label("输入被查询的物资编号："));</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>panel.add(sno); panel.add(btn);</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>add("North",panel); add(text,"Center");</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>text.setEditable(false);btn.addActionListener(this);</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>addWindowListener(new WindowAdapter()</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>public void windowClosing(WindowEvent e)</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >     </span>setVisible(false);</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >     </span>System.exit(0);</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>});</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>public void actionPerformed(ActionEvent e)</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>if(e.getSource()==btn) //当用户按下查询按钮时</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>text.setText("查询结果"+'\n'); //显示提示信息</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>try</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>Liststudent();</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>catch(SQLException ee) { }</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>public void Liststudent() throws SQLException //针对数据库的操作</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>String bh,mc,xh,lb,dw,sj;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>int sl; float dj,je;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>try</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>catch(ClassNotFoundException e) { }&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>Connection con=DriverManager.getConnection("jdbc:odbc:wzgl");</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>Statement sql=con.createStatement(); //创建Statement对象</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>ResultSet rs=sql.executeQuery("select * from wuzi");</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>while(rs.next()) //输出被查询的情况</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>bh=rs.getString("物资编号");</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>mc=rs.getString("物资名称");</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>xh=rs.getString("规格型号");</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>lb=rs.getString("类别");</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>dw=rs.getString("计量单位");</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>sl=rs.getInt("数量");</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>dj=rs.getFloat("单价");</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>je=rs.getFloat("金额");</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>sj=rs.getDate("时间").toString();</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>if(bh.trim().equals(sno.getText().trim()))</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>text.append('\n'+"物资编号"+" "+"物资名称"+" "+"规格型号"+" "+"类别"+" "+"计量单位"+" "+"数量"+" "+"单价"+" "+"金额"+" "+"时间"+'\n');</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>text.append('\n'+bh+" "+mc+" "+xh+" "+lb+" "+dw+" "+sl+" "+dj+" "+je+" "+sj+" "+'\n');</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><br></font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >/**</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >&nbsp;* This is about &lt;code&gt;ClassName&lt;/code&gt;.</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >&nbsp;* {@link com.yourCompany.aPackage.Interface}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >&nbsp;* @author author</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >&nbsp;* @deprecated use &lt;code&gt;OtherClass&lt;/code&gt;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >&nbsp;*/</font></p><p style="font-family: Arial, 宋体; font-size: 14px; line-height: 1.8;"  ></p></div></div></div>
	</div>
</div>
</body>
</html>