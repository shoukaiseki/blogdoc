<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>蒋カイセキ 的博客</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">蒋カイセキ 的博客</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">Oracle删除当前用户下的所有表、视图、序列、函数、存储过程、包</h2>
	<h5 id="">2012-02-04 23:12:14&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/shoukaiseki/blog/static/192856149201214111214333/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><pre class="prettyprint"  ><p>--以下方法1,3本人试过，在sqlplus下最好用的删除，还原方法是：<br>--把删除表，写成脚本：<br>--************************<br>--**方法1<br>--************************<br>--在终端依次输入以下命令<br>sqlplus<br>--输入需要删除的用户名<br>--输入密码<br>SET HEAD OFF <br>SPOOL  /tmp/database/drop_tables.sql <br><br>--chr(13) ASCII中=换行  chr(10) ASCII中=回车<br>--delete tables <br>select 'drop table ' || table_name ||';'||chr(13)||chr(10) from user_tables;   <br>--delete views <br>select 'drop view ' || view_name||';'||chr(13)||chr(10) from user_views;   <br><br><br>--delete seqs <br>select 'drop sequence ' || sequence_name||';'||chr(13)||chr(10) from user_sequences;  <br><br><br>--delete functions <br>select 'drop function ' || object_name||';'||chr(13)||chr(10) from user_objects where object_type='FUNCTION';   <br><br><br>--delete procedure <br>select 'drop procedure ' || object_name||';'||chr(13)||chr(10) from user_objects where object_type='PROCEDURE';   <br><br><br>--delete package <br>select 'drop package ' || object_name||';'||chr(13)||chr(10) from user_objects where object_type='PACKAGE';   <br><br>--delete trigger<br>SELECT 'drop TRIGGER "' ||SYS_CONTEXT('USERENV','CURRENT_USER')||'"."'|| TRIGGER_NAME ||'";' ||CHR(13) ||CHR(10)FROM USER_TRIGGERS<br><br><br>spool off; <br>@/tmp/database/drop_tables.sql; <br><br>purge recyclebin; --清空Oracle的回收站<br><br>--例:(win下进行删除用户asus的所有表)<br>sqlplus<br>asus --用户名<br>asus --密码<br>SET HEAD OFF <br>SPOOL  c:/drop_tables.sql --保存为sql语句<br><br>--chr(13) ASCII中=换行  chr(10) ASCII中=回车<br>--delete tables <br>select 'drop table ' || table_name ||';'||chr(13)||chr(10) from user_tables;<br>--delete views <br>select 'drop view ' || view_name||';'||chr(13)||chr(10) from user_views;   <br>--delete seqs <br>select 'drop sequence ' || sequence_name||';'||chr(13)||chr(10) from user_sequences;  <br>--delete functions <br>select 'drop function ' || object_name||';'||chr(13)||chr(10) from user_objects where object_type='FUNCTION';   <br>--delete procedure <br>select 'drop procedure ' || object_name||';'||chr(13)||chr(10) from user_objects where object_type='PROCEDURE';   <br>--delete package <br>select 'drop package ' || object_name||';'||chr(13)||chr(10) from user_objects where object_type='PACKAGE';   <br>--delete trigger<br>SELECT 'drop TRIGGER "' ||SYS_CONTEXT('USERENV','CURRENT_USER')||'"."'|| TRIGGER_NAME ||'";' ||CHR(13) ||CHR(10)FROM USER_TRIGGERS<br><br>spool off; <br>@c:/drop_tables.sql; <br>purge recyclebin; --清空Oracle的回收站<br>quit --退出sqlplus<br><br>--完成<br><br>--然后再还原数据。<br>--imp maximo/maximo@orcl fromuser=maximo touser=maximo file=21时14分34秒.dmp  tablespaces=tablespaces<br><br><br>--************************<br>--**方法2<br>--************************<br>1　select   Drop   table   ||table_name||;<br>　　from   all_tables<br>　　where   owner=要删除的用户名（注意要大写）;<br>　　2、<br>　　删除所有表<br>　　以用户test为例<br>　　for example:<br>　　declare<br>　　cursor cur1 is select table_name from dba_tables where owner=TEST;<br>　　begin<br>　　for cur2 in cur1 loop<br>　　execute immediate drop table test.||cur2.table_name;<br>　　end loop;<br>　　end;<br>　　3、这个删除当前用户的所有对象(表、视图、触发器、存储过程、函数)<br>　　DECLARE<br>　　TYPE name_list IS TABLE OF VARCHAR2(40);<br>　　TYPE type_list IS TABLE OF VARCHAR2(20);<br>　　Tab_name name_list:=name_list();<br>　　Tab_type type_list:=type_list();<br>　　sql_str VARCHAR2(500);<br>　　BEGIN<br>　　sql_str := select uo.object_name,uo.object_type from user_objects uo where uo.object_type not in(INDEX,LOB) order by uo.object_type desc;<br>　　EXECUTE IMMEDIATE sql_str BULK COLLECT INTO tab_name,tab_type;<br>　　FOR i IN Tab_name.FIRST.. Tab_name.LAST LOOP<br>　　sql_str := DROP || Tab_type(i) || || Tab_name(i);<br>　　EXECUTE IMMEDIATE sql_str;<br>　　END LOOP;<br>　　END;<br><br><br><br>--************************<br>--**方法3<br>--**使用Oracle SQL Developer<br>--************************<br>--用需要删除的用户登入<br>--在工作表中输入以下内容<br>select 'drop table ' || table_name ||';'||chr(13)||chr(10) from user_tables;<br>select 'drop view ' || view_name||';'||chr(13)||chr(10) from user_views;   <br>select 'drop sequence ' || sequence_name||';'||chr(13)||chr(10) from user_sequences;  <br>select 'drop function ' || object_name||';'||chr(13)||chr(10) from user_objects where object_type='FUNCTION';   <br>select 'drop procedure ' || object_name||';'||chr(13)||chr(10) from user_objects where object_type='PROCEDURE';   <br>select 'drop package ' || object_name||';'||chr(13)||chr(10) from user_objects where object_type='PACKAGE';<br>SELECT 'drop TRIGGER "' ||SYS_CONTEXT('USERENV','CURRENT_USER')||'"."'|| TRIGGER_NAME ||'";' ||CHR(13) ||CHR(10)FROM USER_TRIGGERS<br><br>--按F5(运行脚本)<br>--在脚本输出中按Ctrl+F5(将脚本输出作为脚本运行)<br>--按Ctrl+F5后根据脚本自动创建一个工作表窗口,此时按F5(运行脚本)<br><br>purge recyclebin; --清空Oracle的回收站<br>--收工<br></p><div><br></div></pre><br><wbr></div>
	</div>
</div>
</body>
</html>