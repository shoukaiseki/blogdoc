<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>蒋カイセキ 的博客</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">蒋カイセキ 的博客</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">显示隐藏扩展名</h2>
	<h5 id="">2012-01-02 16:55:33&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/shoukaiseki/blog/static/19285614920120245533457/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>@echo off</div><div><br></div><div>　　mode con cols=100 lines=10</div><div><br></div><div>　　title 右键隐藏扩展名</div><div><br></div><div>　　color 0b</div><div><br></div><div>　　if not exist "%windir%\SuperExtension.vbs" goto setup</div><div><br></div><div>　　reg delete "HKCR\CLSID\{00000000-0000-0000-0000-000000000014}" /f &gt;nul 2&gt;nul</div><div><br></div><div>　　del /f /q "%windir%\SuperExtension.vbs" &gt;nul 2&gt;nul</div><div><br></div><div>　　echo.&amp;echo 卸除完毕。 要重新安装请再执行一遍本bat</div><div><br></div><div>　　pause&gt;nul</div><div><br></div><div>　　exit</div><div><br></div><div>　　:setup</div><div><br></div><div>　　color 0a</div><div><br></div><div>　　&gt;"%windir%\SuperExtension.vbs" echo Dim WSHShell</div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo Set WSHShell = WScript.CreateObject("WScript.Shell")</div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo WSHShell.RegWrite "HKCR\CLSID\{00000000-0000-0000-0000-000000000014}\Instance\InitPropertyBag\CLSID", "{13709620-C279-11CE-A49E-444553540000}", "REG_SZ"</div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo WSHShell.RegWrite "HKCR\CLSID\{00000000-0000-0000-0000-000000000014}\Instance\InitPropertyBag\method", "ShellExecute", "REG_SZ"</div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo if WSHShell.RegRead("HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\HideFileExt") = 0 then</div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo WSHShell.RegWrite "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\HideFileExt", "1", "REG_DWORD"</div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo WSHShell.RegWrite "HKCR\CLSID\{00000000-0000-0000-0000-000000000014}\Instance\InitPropertyBag\command", "显示扩展名", "REG_SZ"</div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo WSHShell.SendKeys "{F5}+{F10}e"</div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo else</div><div><br></div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo WSHShell.RegWrite "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\HideFileExt", "0", "REG_DWORD"</div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo WSHShell.RegWrite "HKCR\CLSID\{00000000-0000-0000-0000-000000000014}\Instance\InitPropertyBag\command", "隐藏扩展名", "REG_SZ"</div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo WSHShell.SendKeys "{F5}+{F10}e"</div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo end if</div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo Set WSHShell = Nothing</div><div><br></div><div>　　&gt;&gt;"%windir%\SuperExtension.vbs" echo WScript.Quit(0)</div><div><br></div><div>　　reg export "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" "%temp%\__.reg" &gt;nul</div><div><br></div><div>　　for /f "tokens=2 delims==" %%. in ('find/i "HideFileExt" "%temp%\__.reg"') do set v=%%~.</div><div><br></div><div>　　del "%temp%\__.reg"</div><div><br></div><div>　　set v=%v:~-1%</div><div><br></div><div>　　if %v% equ 0 set vv=隐藏扩展名</div><div><br></div><div>　　if %v% equ 1 set vv=显示扩展名</div><div><br></div><div>　　&gt;"%temp%\_.reg" echo REGEDIT4</div><div><br></div><div>　　&gt;&gt;"%temp%\_.reg" echo [HKEY_CLASSES_ROOT\Directory\Background\shellex\ContextMenuHandlers\SuperExtension]</div><div><br></div><div>　　&gt;&gt;"%temp%\_.reg" echo @="{00000000-0000-0000-0000-000000000014}"</div><div><br></div><div>　　&gt;&gt;"%temp%\_.reg" echo [HKEY_CLASSES_ROOT\CLSID\{00000000-0000-0000-0000-000000000014}\InProcServer32]</div><div><br></div><div>　　&gt;&gt;"%temp%\_.reg" echo @=hex(2):25,53,79,73,74,65,6d,52,6f,6f,74,25,5c,73,79,73,74,65,6d,33,32,5c,73,\</div><div><br></div><div>　　&gt;&gt;"%temp%\_.reg" echo 68,64,6f,63,76,77,2e,64,6c,6c,00</div><div><br></div><div>　　&gt;&gt;"%temp%\_.reg" echo "ThreadingModel"="Apartment"</div><div><br></div><div>　　&gt;&gt;"%temp%\_.reg" echo [HKEY_CLASSES_ROOT\CLSID\{00000000-0000-0000-0000-000000000014}\Instance]</div><div><br></div><div>　　&gt;&gt;"%temp%\_.reg" echo "CLSID"="{3f454f0e-42ae-4d7c-8ea3-328250d6e272}"</div><div><br></div><div>　　&gt;&gt;"%temp%\_.reg" echo [HKEY_CLASSES_ROOT\CLSID\{00000000-0000-0000-0000-000000000014}\Instance\InitPropertyBag]</div><div><br></div><div>　　&gt;&gt;"%temp%\_.reg" echo "method"="ShellExecute"</div><div><br></div><div>　　&gt;&gt;"%temp%\_.reg" echo "Param1"="SuperExtension.vbs"</div><div><br></div><div>　　&gt;&gt;"%temp%\_.reg" echo "CLSID"="{13709620-C279-11CE-A49E-444553540000}"</div><div><br></div><div>　　&gt;&gt;"%temp%\_.reg" echo "command"="%vv%"</div><div><br></div><div>　　regedit /s "%temp%\_.reg"</div><div><br></div><div>　　del /f /q "%temp%\_.reg"</div><div><br></div><div>　　echo.&amp;echo 已添加至右键 再次执行本bat清除出右键菜单</div><div><br></div><div>　　pause&gt;nul</div><div><br></div><div>　　exit</div><div><br></div><wbr></div>
	</div>
</div>
</body>
</html>