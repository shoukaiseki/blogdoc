<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>蒋カイセキ 的博客</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">蒋カイセキ 的博客</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">成功编译Linux3.2-rc6内核</h2>
	<h5 id="">2011-12-24 13:59:24&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/shoukaiseki/blog/static/1928561492011112403545886/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>先说明以下我的系统为Fedora 16 Verne,编译内核所许的包请查看我的Linux分类下的<font color="#ff0000"  >Linux安装与卸载NVIDIA驱动</font></div><div>[fedora@fedora ~]$ uname -a</div><div>Linux fedora 3.2.0-rc6 #1 SMP Sat Dec 24 00:40:17 CST 2011 i686 i686 i386 GNU/Linux</div><div>[fedora@fedora ~]$&nbsp;</div><div>说来惭愧，主要是前天装Linux显卡驱动造成无法进Gnome桌面，卸载掉驱动也没用，按照网上说的使用</div><div><span style="line-height: 22px;"  >[root@fedora ~]</span>#X -configure生成一个新的xorg.conf.new,然后</div><div><span style="line-height: 22px;"  >[root@fedora ~]</span><span style="line-height: 22px;"  >#</span>cp /root/xorg.conf.new /etc/X11/xorg.conf还是没用</div><div>我就打算升级内核看下,打算再不行就卸载Gnome再重装下Gnome试一下的.先来说说我编译内核用的几个命令吧</div><div><div>cd /tmp</div></div><div><span style="line-height: 22px;"  >[root@fedora&nbsp;</span><span style="line-height: 22px;"  >tmp</span><span style="line-height: 22px;"  >]</span><span style="line-height: 22px;"  >#</span>wget&nbsp;http://www.kernel.org/pub/linux/kernel/v3.0/testing/linux-3.2-rc6.tar.bz2</div><div>下载好了源码包开始解压吧,不过解压前注意用uname查看下内核版本,和/usr/src/kernels目录下有没同版本目录</div><div><span style="line-height: 22px;"  >[root@fedora&nbsp;</span><span style="line-height: 22px;"  >tmp</span><span style="line-height: 22px;"  >]</span><span style="line-height: 22px;"  >#tar -jxvf linux-3.2-rc6.tar.bz2 -C /usr/src/kernels</span></div><div><span style="line-height: 22px;"  >cd /usr/src/kernels/linux-3.2-rc6</span></div><div><span style="font-family: 宋体; line-height: 24px;"  >在开始配置内核之前，首先需要通过下面的命令清除所有的临时文件、中间件和配置文件。对于一个刚从网上下载的内核来说，它肯定是干净的，这么做只会多此一举。但是这是一个良好习惯，而且不会有坏结果。(这个当时我没执行)</span></div><div><span style="line-height: 22px;"  >[root@fedora&nbsp;</span><span style="line-height: 22px;"  >linux-3.2-rc6</span><span style="line-height: 22px;"  >]</span><span style="line-height: 22px;"  >#</span><span style="font-family: 宋体; line-height: 24px;"  >make&nbsp;mrproper</span></div><div><span style="line-height: 22px;"  >然后执行make menuconfig来配置内核,具体配置请查看</span><a rel="nofollow" href="http://www.linuxsir.org/bbs/thread290748.html"  >http://www.linuxsir.org/bbs/thread290748.html</a>或</div><div><a rel="nofollow" href="http://linux.chinaitlab.com/kernel/531925_4.html"  >http://linux.chinaitlab.com/kernel/531925_4.html</a></div><div>反正配置好后选择刚进入的配置界面的save保存下即可,我当时情急,没有细选,你有时间可以慢慢选</div><div><span style="line-height: 22px;"  >[root@fedora&nbsp;</span><span style="line-height: 22px;"  >linux-3.2-rc6</span><span style="line-height: 22px;"  >]</span><span style="line-height: 22px;"  >#make menuconfig</span></div><div>配置完成了就开始make吧,其中的-j[N]参数是"同时允许 N 个任务",有的说这个N取值,如果你想压榨最大性能的话采用核心数+1,有得说可以取为核心数*2,我当时是拿手机看的,因为图形界面进不了了,就没仔细分析了,反正我4核编译的时候才用的是j8</div><div><span style="line-height: 22px;"  >[root@fedora&nbsp;</span><span style="line-height: 22px;"  >linux-3.2-rc6</span><span style="line-height: 22px;"  >]</span><span style="line-height: 22px;"  >#make -j8</span></div><div>编译基本查不多完成了,反正我是凌晨1点开始在编译后我就去睡觉了,第二天11:30过来的时候已经编译好了</div><div><div>然后安装模块：</div></div><div><span style="line-height: 22px;"  >[root@fedora&nbsp;</span><span style="line-height: 22px;"  >linux-3.2-rc6</span><span style="line-height: 22px;"  >]</span><span style="line-height: 22px;"  >#</span><span style="line-height: 22px;"  >make modules_install&nbsp;</span><span style="line-height: 22px;"  >-j8</span><span style="line-height: 22px;"  >&nbsp;</span></div><div>安装内核:</div><div><span style="line-height: 22px;"  >[root@fedora&nbsp;</span><span style="line-height: 22px;"  >linux-3.2-rc6</span><span style="line-height: 22px;"  >]</span><span style="line-height: 22px;"  >#</span><span style="line-height: 22px;"  >make install</span></div><div>这样就完成了,OK了</div><div><div style="line-height: 22px;"  >好像有的文章说还要编译编译内核： make bzImage&nbsp;<span style="line-height: 22px;"  >编译模块：make modules,我反正都没用到,还有啥配置grub之类的,我看grub2菜单中已经有了就直接重启机子选择新内核了</span></div></div><wbr></div>
	</div>
</div>
</body>
</html>