<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>蒋カイセキ 的博客</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">蒋カイセキ 的博客</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">java 最大JVM可用内存测试</h2>
	<h5 id="">2016-01-27 11:13:10&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/shoukaiseki/blog/static/1928561492016027111310932/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div>编译之后运行方式</div><div>java -Xms3448M -Xmx3448M TestJdkCG</div><div><div><span style="line-height: 28px;"   >以这种方式修改内存配置参数运行，调节过程中[增量次数越多]，运行时所能够正常使用的内存就越大</span></div><div>切记，不可过分调到系统剩余内存之外，小心卡死</div></div><div><pre class="prettyprint"   ><p>import java.util.HashMap;<br>import java.util.Random;  <br><br>public class TestJdkCG {<br><br>	public TestJdkCG(){<br>		HashMap&lt;Long, String&gt; map=new HashMap&lt;Long, String&gt;();<br>		StringBuffer sb=new StringBuffer();<br>		long i=0L;<br>		while(true){<br>			//每次增量1MB<br>			map.put(i,randomString(1024*1024));<br>//			sb.append(randomString(1024*1024));<br>			++i;<br>			<br>			printMemoryMSG(i,sb);<br>			<br>//			try {<br>//				Thread.sleep(50);<br>//			} catch (InterruptedException e) {<br>//				// TODO Auto-generated catch block<br>//				e.printStackTrace();<br>//			}<br>		}<br>	}<br><br>	public static void main(String[] strs){<br>		//java -Xms3448M -Xmx3448M TestJdkCG<br>		//以这种方式修改内存配置参数运行，调节过程中[增量次数越多]，运行时所能够正常使用的内存就越大<br>		//切记，不可过分调到系统剩余内存之外，小心卡死<br>		System.out.println("java -Xms3448M -Xmx3448M TestJdkCG");<br>		System.out.println("以这种方式修改内存配置参数运行，调节过程中[增量次数越多]，运行时所能够正常使用的内存就越大");<br>		System.out.println("切记，不可过分调到系统剩余内存之外，小心卡死");<br>		new TestJdkCG();<br>	}<br><br><br>	public void printMemoryMSG(long frequency	,StringBuffer sb){<br>		long totalMemory=Runtime.getRuntime().totalMemory()/1024/1024;<br>		long maxMemory=Runtime.getRuntime().maxMemory()/1024/1024;<br>		long freeMemory=Runtime.getRuntime().freeMemory()/1024/1024;<br><br>		if(osName.equalsIgnoreCase("linux")){<br>			moveToFirstLine();<br>			clearToEndOfLine();<br>			print("增量次数["+frequency+"]");<br>			print("虚拟机中的内存总量="+printFormatColor(totalMemory+"", "36m")+"MB,");<br>			print("虚拟机试图使用的最大内存量="+printFormatColor(maxMemory+"", "36m")+"MB,");<br>			print("虚拟机中的空闲内存量="+printFormatColor(freeMemory+"", "36m")+"MB");<br>		}else{<br>//			moveToFirstLine();<br>			clearToEndOfLine();<br>			print("增量次数["+frequency+"]");<br>			print("虚拟机中的内存总量="+totalMemory+"MB,");<br>			print("最大内存量="+maxMemory+"MB,");<br>			print("空闲内存量="+freeMemory+"MB");<br>		}<br>		<br>	}<br>	<br>	/**<br>	 * @param str 颜色内容<br>	 * @param colorCode 颜色代码<br>	 * @return<br>	 */<br>	public  String printFormatColor(String str,String colorCode) {<br>		// TODO Auto-generated method stub<br><br>		return new StringBuffer("\033[").append(colorCode).append(str).append("\033[0m").toString();<br>	}<br><br>	/**<br>	 * 产生随机字符串<br>	 * */<br>	private static Random randGen = null;<br>	private static char[] numbersAndLetters = null;<br><br>	public static final String randomString(int length) {<br>		if (length &lt; 1) {<br>			return null;<br>		}<br>		if (randGen == null) {<br>			randGen = new Random();<br>			numbersAndLetters = ("0123456789abcdefghijklmnopqrstuvwxyz" +<br>					"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ").toCharArray();<br>			//numbersAndLetters = ("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ").toCharArray();<br>		}<br>		char [] randBuffer = new char[length];<br>		for (int i=0; i&lt;randBuffer.length; i++) {<br>			randBuffer[i] = numbersAndLetters[randGen.nextInt(71)];<br>			//randBuffer[i] = numbersAndLetters[randGen.nextInt(35)];<br>		}<br>		return new String(randBuffer);<br>	}<br><br><br><br><br><br>	<br><br><br><br><br>	/**<br>	 * [藏光<br>	 */<br>	public static final String HIDETHECURSOR="\033[?25l\033[0m";<br>	/**<br>	 * @示光<br>	 */<br>	public static final String SHOWTHECURSOR="\033[?25h\033[0m";<br>	/**<br>	 * 清除从光标到行尾的内容 <br>	 */<br>	public static final String CLEARTOENDOFLINE="\033[K\033[0m";<br>	<br>	/**<br>	 * 清屏<br>	 */<br>	public static final String CLEARALL="\033[2J\033[0m";<br>	/**<br>	 * 移拥叫惺<br>	 */<br>	public static final String MOVETOFIRSTLINE="\033[888D\033[0m";<br>	<br>	private String osName=System.getProperty("os.name").toLowerCase();<br>	<br>	/**<br>	 *  @see #CLEARTOENDOFLINE<br>	 */<br>	public void clearToEndOfLine(){<br>		if(osName.equalsIgnoreCase("linux")){<br>			print(CLEARTOENDOFLINE);	<br>		}else{<br>			print("\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b");<br>//			for (int i = 0; i &lt; 200; i++) {<br>//				print("\b");<br>//			}<br>		}<br>	}<br>	/**<br>	 *  @see #CLEARALL<br>	 */<br>	public void clear(){<br>		if(osName.equalsIgnoreCase("linux")){<br>			print(CLEARALL);<br>		}<br>	}<br>	<br>	/**<br>	 *  @see #MOVETOFIRSTLINE<br>	 */<br>	public void moveToFirstLine(){<br>		if(osName.equalsIgnoreCase("linux")){<br>			print(MOVETOFIRSTLINE);<br>		}<br>		<br>	}<br>	<br>	/**<br>	 *  @see #HIDETHECURSOR<br>	 */<br>	public void hideTheCursor(){<br>		if(osName.equalsIgnoreCase("linux")){<br>			print(HIDETHECURSOR);<br>		}<br>	}<br>	<br>	/**<br>	 *  @see #SHOWTHECURSOR<br>	 */<br>	public void showTheCursor(){<br>		if(osName.equalsIgnoreCase("linux")){<br>			print(SHOWTHECURSOR);<br>		}<br>	}<br>	<br><br><br>	/** K端出,如果不 linux 系yt不出<br>	 * @param o<br>	 */<br>	public void print(Object o){<br>		if(osName.equalsIgnoreCase("linux")){<br>			System.out.print(o);<br>		}else{<br>			System.out.print(o);<br>		}<br>	}<br>	<br>}<br></p><div><br></div></pre><br></div></div>
	</div>
</div>
</body>
</html>