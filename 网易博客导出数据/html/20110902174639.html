<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=gbk">
<title>蒋カイセキ 的博客</title>
<style type="text/css">
.blogcnt{line-height:160%;font-size:14px;text-align:left;word-wrap:break-word;}
.blogcnt *{line-height:160%;}
.blogcnt p{margin:0 0 10px;}
.blogcnt ul,.nbw-blog ol{margin:5px 0 5px 40px;padding:0}
.blogcnt em{font-style:italic;}
.blogcnt blockquote{font-size:1em;margin:auto 0 auto 35px;}
.blogcnt img{border:0;max-width:100%;}
</style>
</head>
<body style="color:#444444;">
<h1 id="blog-Title"><a href="index.html">蒋カイセキ 的博客</a></h1>
<div id="" style="padding:0 20px;">
	<h2 id="">java访问sql数据库 (采用驱动访问)</h2>
	<h5 id="">2011-09-02 17:46:39&nbsp;&nbsp;&nbsp;<a href="http://blog.163.com/shoukaiseki/blog/static/19285614920118254639597/" target="_blank">查看原文&gt;&gt;</a></h5>
	<div class="" id="" style="padding:0 20px;">
		<div class="blogcnt" style="width:800px;"><div><div style="background-color: rgb(255, 255, 255); margin-top: 10px; margin-right: 10px; margin-bottom: 10px; margin-left: 10px; cursor: text; word-wrap: break-word;"  ><font face="Arial, 宋体"  ><span style="line-height: 1.8;"  >1.安装</span></font><a style="font-family: Arial, &#23435;&#20307;; font-size: 14px; line-height: 1.8; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; " target="_blank" rel="nofollow" href="http://115.com/file/cljh65o1#"  >microsoft SQL Server2000</a><font face="Arial, 宋体"  ><span style="line-height: 1.8;"  >&nbsp;开发版&nbsp;SQLServer20004in1cn.iso 下载地址</span></font><a style="font-family: Arial, &#23435;&#20307;; font-size: 14px; line-height: 1.8; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; " target="_blank" rel="nofollow" href="http://115.com/file/cljh65o1#"  >http://115.com/file/cljh65o1#</a><div style="font-family: Arial, 宋体; font-size: 14px; line-height: 1.8;"  >&nbsp; &nbsp;安装过程请查看<a style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; " target="_blank" rel="nofollow" href="http://115.com/file/dn3zsxpk#"  >SQL_Server_2000安装图解说明.doc</a>&nbsp;下载地址<a style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; " target="_blank" rel="nofollow" href="http://115.com/file/dn3zsxpk#"  >http://115.com/file/dn3zsxpk#</a></div><p style="font-family: Arial, 宋体; font-size: 14px; line-height: 1.8; margin-top: 0.5em; margin-bottom: 0.5em;"  >&nbsp; &nbsp;安装过程中的sa密码建议设置为空,当然也可设置自己想要的密码</p><p style="font-family: Arial, 宋体; font-size: 14px; line-height: 1.8; margin-top: 0.5em; margin-bottom: 0.5em;"  >2.安装SQL SP4补丁<a style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; " target="_blank" rel="nofollow" href="http://115.com/file/e6enx9hs#"  >SQL2000.MSDE-KB884525-SP4-x86-CHS.exe</a>&nbsp;下载地址<a style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; " target="_blank" rel="nofollow" href="http://115.com/file/e6enx9hs#"  >http://115.com/file/e6enx9hs#</a></p><p style="font-family: Arial, 宋体; font-size: 14px; line-height: 1.8; margin-top: 0.5em; margin-bottom: 0.5em;"  >&nbsp; &nbsp;安装过程跟第一步一样,只是密码设置要安装第一步设置的密码,如果第一步密码为空这次也为空</p><p style="font-family: Arial, 宋体; font-size: 14px; line-height: 1.8; margin-top: 0.5em; margin-bottom: 0.5em;"  >3.安装java访问sql驱动<a style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; " target="_blank" rel="nofollow" href="http://115.com/file/cljh6eu2#"  >sqlserver2000jdbcsericepack3.exe</a>&nbsp;下载地址<a style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; " target="_blank" rel="nofollow" href="http://115.com/file/cljh6eu2#"  >http://115.com/file/cljh6eu2#</a></p><p style="font-family: Arial, 宋体; font-size: 14px; line-height: 1.8; margin-top: 0.5em; margin-bottom: 0.5em;"  >&nbsp; &nbsp;安装后的目录为C:\Program Files\Microsoft SQL Server 2000 Driver for JDBC\lib</p><p style="font-family: Arial, 宋体; font-size: 14px; line-height: 1.8; margin-top: 0.5em; margin-bottom: 0.5em;"  >&nbsp; &nbsp;可查看<a style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; " target="_blank" rel="nofollow" href="http://115.com/file/e6enxnma#"  >Java连接SQL_Server_2000.pdf</a>&nbsp;下载地址<a style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; " target="_blank" rel="nofollow" href="http://115.com/file/e6enxnma#"  >http://115.com/file/e6enxnma#</a></p><p style="font-family: Arial, 宋体; font-size: 14px; line-height: 1.8; margin-top: 0.5em; margin-bottom: 0.5em;"  >4.开始-&gt;程序-&gt;Microsoft SQL Server-&gt;企业管理器---&gt;Microsoft SQL server-&gt;SQL server组-&gt;local-&gt;右键点击数据库</p><p style="font-family: Arial, 宋体; font-size: 14px; line-height: 1.8; margin-top: 0.5em; margin-bottom: 0.5em;"  >&nbsp; &nbsp;-&gt;新建数据库mydata-&gt;mydata-&gt;右键点击表-&gt;</p><p style="font-family: Arial, 宋体; font-size: 14px; line-height: 1.8; margin-top: 0.5em; margin-bottom: 0.5em;"  >新建表<img title="java访问sql数据库 (采用驱动访问) - Linux Fedora 15 - 蒋カイセキ的博客"  alt="java访问sql数据库 (采用驱动访问) - Linux Fedora 15 - 蒋カイセキ的博客"  src="file:///C:/%20Documents%20and%20Settings%20Administrator%20Application%20Data%20Tencent%20Users%20438658902%20QQ%20WinTemp%20RichOle%204B7N%XR~%20K0@FK%20G(9O%7B%7D1M.jpg"  ><span><img title="java访问sql数据库 (采用驱动访问) - Linux Fedora 15 - 蒋カイセキ的博客"  alt="java访问sql数据库 (采用驱动访问) - Linux Fedora 15 - 蒋カイセキ的博客"  src="http://img.ph.126.net/wqDYR1pcl3LHz8JYUPwLpw==/2378745028182473323.jpg"  small="0"  border="0"  ></span>-&gt;保存名为asus-&gt;右键点击表asus-&gt;打开表-&gt;返回所以行-&gt;<span><img title="java访问sql数据库 (采用驱动访问) - Linux Fedora 15 - 蒋カイセキ的博客"  alt="java访问sql数据库 (采用驱动访问) - Linux Fedora 15 - 蒋カイセキ的博客"  src="http://img.ph.126.net/V7E15quuIpGxbqWPUNXboA==/2378745028182473324.jpg"  small="0"  border="0"  ></span></p><p style="font-family: Arial, 宋体; line-height: 1.8; margin-top: 0.5em; margin-bottom: 0.5em;"  >5.<span style="font-family: Arial, Helvetica, sans-serif; line-height: 22px;"  ><a target="_blank" rel="nofollow" href="http://hi.baidu.com/jiangxinyi21/blog/item/21bb5e16dd6d28ef1ad57676.html"  ><font color="#ff6600"  size="4"  >查看高亮源代码</font></a></span></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >import java.sql.*;&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >import java.io.*;&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >public class DBColumn&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >{</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>public static void main(String[] args)&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>{&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>Connection con=null;&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>Statement sm=null;&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>String command=null;&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>ResultSet rs=null;&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>String tableName=null;&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>String cName=null;&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>String result=null;&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>BufferedReader input=new BufferedReader(new InputStreamReader(System.in));&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>try&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>{&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>Class.forName("com.microsoft.jdbc.sqlserver.SQLServerDriver");&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>System.out.println("驱动程序已加载");&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>//SQL SERVER的登陆方式必须为使用SQL SERVER密码登陆认证方式&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>//("jdbc:microsoft:sqlserver://服务器地址:访问端口","SQL用户名","SQL密码");&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>con=DriverManager.getConnection("jdbc:microsoft:sqlserver://127.0.0.1:1433","sa","");&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>con.setCatalog("mydata");//数据库名</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>System.out.println("OK,成功连接到数据库mydata");&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>catch(Exception ex)</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>{&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>ex.printStackTrace();&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>}&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>try&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>{&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>sm=con.createStatement();&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>System.out.println("输入表名asus ");&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>//tableName=input.readLine(); //手动输入表名</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>//tableName="TeacherBasicInf";//设置表名为TeacherBasicInf&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>tableName="asus";//设置表名为asus</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>while(true)</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>{&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>System.out.println("输入列名(为空时程序结束):");&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>cName=input.readLine(); //输入列名name</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>if(cName.equalsIgnoreCase(""))&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >     </span>break;&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>command="select "+cName+" from "+tableName;&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>rs=sm.executeQuery(command);&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>if(!rs.next())&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >     </span>System.out.println("表名或列名输入有误");&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>else</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >    </span>{&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >     </span>System.out.println("查询结果为:");&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >     </span>do&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >     </span>{&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >      </span>//result=rs.getString(cName);&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >      </span>//result=new String(result.getBytes("ISO-8859-1"),"GB2312");&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >      </span>System.out.println(rs.getString(1));//System.out.println(result);&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >     </span>}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >     </span>while(rs.next());&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >     </span>}&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>}&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>System.out.println("查询结束!");</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>}</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>catch(Exception ex)</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>{&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >   </span>ex.printStackTrace();&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  >  </span>}&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  ><span style="white-space:pre;"  > </span>}&nbsp;</font></p><p style="margin-top: 0.5em; margin-bottom: 0.5em;"  ><font face="Arial, 宋体"  >}</font></p></div></div></div>
	</div>
</div>
</body>
</html>